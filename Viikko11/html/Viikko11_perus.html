
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Viikko 11 teht&auml;v&auml;t</title><meta name="generator" content="MATLAB 9.11"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2022-03-18"><meta name="DC.source" content="Viikko11_perus.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Viikko 11 teht&auml;v&auml;t</h1><!--introduction--><div><ul><li>Harjoitus 2 perusteht&auml;v&auml;t</li><li>Arno T&ouml;r&ouml;</li></ul></div><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Teht&auml;v&auml; 1</a></li><li><a href="#2">Teht&auml;v&auml; 2</a></li><li><a href="#3">Teht&auml;v&auml; 2b</a></li><li><a href="#4">Teht&auml;v&auml; 3</a></li></ul></div><h2 id="1">Teht&auml;v&auml; 1</h2><pre class="codeinput">clc;clear;close <span class="string">all</span>
<span class="comment">% funktion ja sen derivaatan m&auml;&auml;ritys</span>
f = @(x) 5.*exp(-0.1.*x);
df = @(x) -0.5.*exp(-0.1.*x);

x = -4:0.1:4;
<span class="comment">% funktion piirt&auml;minen</span>
plot(x, f(x)); axis <span class="string">equal</span>

a = 2; <span class="comment">% valittiin a:n arvoksi 2</span>
h = 0.01;
<span class="comment">% numeerinen derivaatta kolmella eri tyylill&auml;</span>
<span class="comment">% eteenp&auml;in</span>
eteenF = (f(a+h)-f(a))/h

<span class="comment">% taaksep&auml;in</span>
taakseF = (f(a)-f(a-h))/h

<span class="comment">% keskeisdifferenssi</span>
keskiF = (f(a+h)-f(a-h))/(2*h)

<span class="comment">% tangentin piirto</span>
xx = -1:0.1:5;
tg = @(x) f(a) + df(a)*(x-a); <span class="comment">% tangentin yht&auml;l&ouml;</span>
hold <span class="string">on</span>
plot(a, f(a),<span class="string">'*'</span>,a+h,f(a+h),<span class="string">'*'</span>); <span class="comment">% pisteet a ja a+h</span>
plot(xx, tg(xx)) <span class="comment">% tangentin piirto</span>

<span class="comment">% 3 eri differenssimenetelm&auml;ll&auml; saadut vastaukset ovat</span>
<span class="comment">% j&auml;rkevi&auml; likiarvoja, sill&auml; kuvaajasta tarkistamalla x:n</span>
<span class="comment">% muutosnopeus on samaa luokkaa yht&auml; yksikk&ouml;&auml; kohden.</span>
</pre><pre class="codeoutput">
eteenF =

   -0.4092


taakseF =

   -0.4096


keskiF =

   -0.4094

</pre><img vspace="5" hspace="5" src="Viikko11_perus_01.png" alt=""> <h2 id="2">Teht&auml;v&auml; 2</h2><pre class="codeinput">clc;clear;close <span class="string">all</span>

f = @(x,y) -x.^2+2.*y.^2; <span class="comment">% funktion m&auml;&auml;rittely</span>
[X,Y] = meshgrid(-4:0.1:4); <span class="comment">% alueen alustaminen piirtoa varten</span>
Z = f(X,Y); <span class="comment">% lasketaan z-koordinaatit funktiosta</span>

figure(1);
surf(X,Y,Z); shading <span class="string">interp</span>; <span class="comment">% pinnan piirto</span>

xlabel(<span class="string">'x'</span>); ylabel(<span class="string">'y'</span>);zlabel(<span class="string">'f(x,y)'</span>); <span class="comment">% akseleiden nime&auml;minen</span>

x0 = [2,-3.2]'; <span class="comment">% derivaatan piste</span>
h = 0.05;

v = [-1 2]'; <span class="comment">% suuntavektori</span>
v0 = v/norm(v); <span class="comment">% normeeraus</span>

f1 = @(x) f(x(1),x(2)); <span class="comment">% laskentaa varten</span>

fv = (f1(x0)-f1(x0-(h*v0)))/h <span class="comment">% derivaatta x0 pisteess&auml;</span>
<span class="comment">% vektorin v suuntaan taaksep&auml;in laskettuna</span>

hold <span class="string">on</span>;
view(-69,9)

<span class="comment">% vektorin piirto</span>
quiver3(x0(1),x0(2),f1(x0),v0(1),v0(2),fv,LineWidth=2);
legend(<span class="string">'Pinta'</span>,<span class="string">'Vektori'</span>);
hold <span class="string">off</span>;

<span class="comment">% derivaatan arvo kuulostaa j&auml;rkev&auml;lt&auml;, sill&auml; piirretty vektori siirtyy oikeaan</span>
<span class="comment">% suuntaan ja n&auml;ytt&auml;&auml; laskevan sopivan jyrk&auml;sti derivaatan arvoon</span>
<span class="comment">% verrattuna</span>
</pre><pre class="codeoutput">
fv =

   -9.7298

</pre><img vspace="5" hspace="5" src="Viikko11_perus_02.png" alt=""> <h2 id="3">Teht&auml;v&auml; 2b</h2><pre class="codeinput">clc;clear
f = @(x,y,z) sin(x*y*z)+log(x*y); <span class="comment">% funktion m&auml;&auml;rittely</span>

x0 = [1 1 2]';
h = 0.05;

<span class="comment">% osittaiderivaatat likiarvoittain</span>
dfx = (f(x0(1)+h,x0(2),x0(3))-f(x0(1),x0(2),x0(3)))/h
dfy = (f(x0(1),x0(2)+h,x0(3))-f(x0(1),x0(2),x0(3)))/h
dfz = (f(x0(1),x0(2),x0(3)+h)-f(x0(1),x0(2),x0(3)))/h

<span class="comment">% derivaatta-lausekkeiden m&auml;&auml;rittely</span>
tdfx = @(x,y,z) y*z*cos(x*y*z) + 1/x;
tdfy = @(x,y,z) x*z*cos(x*y*z) + 1/y;
tdfz = @(x,y,z) x*y*cos(x*y*z);

<span class="comment">% tarkat derivaatat</span>
tarkkaDX = tdfx(x0(1),x0(2),x0(3))
tarkkaDY = tdfy(x0(1),x0(2),x0(3))
tarkkaDZ = tdfz(x0(1),x0(2),x0(3))

<span class="comment">% likiarvojen eroavuus tarkoista prosentteina</span>
prosenttiX = ((tarkkaDX-dfx)/tarkkaDX)*100 <span class="comment">% tarkka arvo on noin 68% suurempi kuin liki</span>
prosenttiY = ((tarkkaDY-dfy)/tarkkaDY)*100 <span class="comment">% tarkka arvo on noin 68% suurempi kuin liki</span>
prosenttiZ = ((tarkkaDZ-dfz)/tarkkaDZ)*100 <span class="comment">% tarkka arvo on noin 5% pienempi kuin liki</span>
</pre><pre class="codeoutput">
dfx =

    0.0540


dfy =

    0.0540


dfz =

   -0.4387


tarkkaDX =

    0.1677


tarkkaDY =

    0.1677


tarkkaDZ =

   -0.4161


prosenttiX =

   67.7758


prosenttiY =

   67.7758


prosenttiZ =

   -5.4198

</pre><h2 id="4">Teht&auml;v&auml; 3</h2><pre class="codeinput">clc;clear;close <span class="string">all</span>

f = @(x) x/10;
g = @(x) 2*sin((x-1)./(1+x.^2));
x = 0.5:0.1:1.4;

<span class="comment">% a.) kohta</span>
figure(1);
plot(x,f(x));
hold <span class="string">on</span>
plot(x,g(x));
legend(<span class="string">'x/10'</span>,<span class="string">'2*sin((x-1)/(1+x^2))'</span>);
<span class="comment">% kuvaajasta katsomalla saadaan yhdeksi ratkaisuksi noin x = 1.13</span>

<span class="comment">% b.) kohta</span>
f0 = @(x) x/10-2*sin((x-1)./(1+x.^2)); <span class="comment">% f(x)=0 funktion m&auml;&auml;rittely</span>
figure(2);
plot(x,f0(x));
hold <span class="string">on</span>
plot(x, zeros(size(x))); <span class="comment">% piirretty x-akseli</span>
legend(<span class="string">'x/10-2*sin((x-1)/(1+x^2))'</span>,<span class="string">'x = 0'</span>);
<span class="comment">% my&ouml;s t&auml;ss&auml; tapauksessa kuvaajaa katsoessa</span>
<span class="comment">% yhdeksi yht&auml;l&ouml;n ratkaisuksi asettuu noin x = 1.13</span>
</pre><img vspace="5" hspace="5" src="Viikko11_perus_03.png" alt=""> <img vspace="5" hspace="5" src="Viikko11_perus_04.png" alt=""> <p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2021b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Viikko 11 tehtävät
% * Harjoitus 2 perustehtävät
% * Arno Törö
% 

%% Tehtävä 1
clc;clear;close all
% funktion ja sen derivaatan määritys
f = @(x) 5.*exp(-0.1.*x);
df = @(x) -0.5.*exp(-0.1.*x);

x = -4:0.1:4;
% funktion piirtäminen
plot(x, f(x)); axis equal

a = 2; % valittiin a:n arvoksi 2
h = 0.01;
% numeerinen derivaatta kolmella eri tyylillä
% eteenpäin
eteenF = (f(a+h)-f(a))/h

% taaksepäin
taakseF = (f(a)-f(a-h))/h

% keskeisdifferenssi
keskiF = (f(a+h)-f(a-h))/(2*h)

% tangentin piirto
xx = -1:0.1:5;
tg = @(x) f(a) + df(a)*(x-a); % tangentin yhtälö
hold on
plot(a, f(a),'*',a+h,f(a+h),'*'); % pisteet a ja a+h
plot(xx, tg(xx)) % tangentin piirto

% 3 eri differenssimenetelmällä saadut vastaukset ovat
% järkeviä likiarvoja, sillä kuvaajasta tarkistamalla x:n
% muutosnopeus on samaa luokkaa yhtä yksikköä kohden.

%% Tehtävä 2
clc;clear;close all

f = @(x,y) -x.^2+2.*y.^2; % funktion määrittely
[X,Y] = meshgrid(-4:0.1:4); % alueen alustaminen piirtoa varten
Z = f(X,Y); % lasketaan z-koordinaatit funktiosta

figure(1);
surf(X,Y,Z); shading interp; % pinnan piirto

xlabel('x'); ylabel('y');zlabel('f(x,y)'); % akseleiden nimeäminen

x0 = [2,-3.2]'; % derivaatan piste
h = 0.05;

v = [-1 2]'; % suuntavektori
v0 = v/norm(v); % normeeraus

f1 = @(x) f(x(1),x(2)); % laskentaa varten

fv = (f1(x0)-f1(x0-(h*v0)))/h % derivaatta x0 pisteessä
% vektorin v suuntaan taaksepäin laskettuna

hold on;
view(-69,9)

% vektorin piirto
quiver3(x0(1),x0(2),f1(x0),v0(1),v0(2),fv,LineWidth=2);
legend('Pinta','Vektori'); 
hold off;

% derivaatan arvo kuulostaa järkevältä, sillä piirretty vektori siirtyy oikeaan
% suuntaan ja näyttää laskevan sopivan jyrkästi derivaatan arvoon
% verrattuna
%% Tehtävä 2b
clc;clear
f = @(x,y,z) sin(x*y*z)+log(x*y); % funktion määrittely
 
x0 = [1 1 2]';
h = 0.05;

% osittaiderivaatat likiarvoittain
dfx = (f(x0(1)+h,x0(2),x0(3))-f(x0(1),x0(2),x0(3)))/h
dfy = (f(x0(1),x0(2)+h,x0(3))-f(x0(1),x0(2),x0(3)))/h
dfz = (f(x0(1),x0(2),x0(3)+h)-f(x0(1),x0(2),x0(3)))/h

% derivaatta-lausekkeiden määrittely
tdfx = @(x,y,z) y*z*cos(x*y*z) + 1/x;
tdfy = @(x,y,z) x*z*cos(x*y*z) + 1/y;
tdfz = @(x,y,z) x*y*cos(x*y*z);

% tarkat derivaatat
tarkkaDX = tdfx(x0(1),x0(2),x0(3))
tarkkaDY = tdfy(x0(1),x0(2),x0(3))
tarkkaDZ = tdfz(x0(1),x0(2),x0(3))

% likiarvojen eroavuus tarkoista prosentteina
prosenttiX = ((tarkkaDX-dfx)/tarkkaDX)*100 % tarkka arvo on noin 68% suurempi kuin liki
prosenttiY = ((tarkkaDY-dfy)/tarkkaDY)*100 % tarkka arvo on noin 68% suurempi kuin liki
prosenttiZ = ((tarkkaDZ-dfz)/tarkkaDZ)*100 % tarkka arvo on noin 5% pienempi kuin liki

%% Tehtävä 3
clc;clear;close all

f = @(x) x/10;
g = @(x) 2*sin((x-1)./(1+x.^2));
x = 0.5:0.1:1.4;

% a.) kohta
figure(1);
plot(x,f(x));
hold on
plot(x,g(x));
legend('x/10','2*sin((x-1)/(1+x^2))');
% kuvaajasta katsomalla saadaan yhdeksi ratkaisuksi noin x = 1.13

% b.) kohta
f0 = @(x) x/10-2*sin((x-1)./(1+x.^2)); % f(x)=0 funktion määrittely
figure(2);
plot(x,f0(x));
hold on
plot(x, zeros(size(x))); % piirretty x-akseli
legend('x/10-2*sin((x-1)/(1+x^2))','x = 0');
% myös tässä tapauksessa kuvaajaa katsoessa 
% yhdeksi yhtälön ratkaisuksi asettuu noin x = 1.13


##### SOURCE END #####
--></body></html>